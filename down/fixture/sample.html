<html><head></head><body><h1 id="frontman">frontman</h1>
<pre class="lang-go prettyprint" style="border: 1px solid #888; padding: 2px;"><code class="lang-go prettyprint">
<span class="kwd" style="color: #008;">package</span> <span class="pln" style="color: #000;">down</span>

<span class="kwd" style="color: #008;">import</span> <span class="pun" style="color: #660;">(</span>
    <span class="str" style="color: #080;">&#34;io&#34;</span>
    <span class="str" style="color: #080;">&#34;io/ioutil&#34;</span>

    <span class="str" style="color: #080;">&#34;github.com/gernest/douceur/inliner&#34;</span>
    <span class="str" style="color: #080;">&#34;github.com/gernest/douceur/parser&#34;</span>
    <span class="str" style="color: #080;">&#34;github.com/gernest/mark&#34;</span>
<span class="pun" style="color: #660;">)</span>

<span class="kwd" style="color: #008;">const</span> <span class="typ" style="color: #606;">DeafultTheme</span> <span class="pun" style="color: #660;">=</span> <span class="str" style="color: #080;">&#34;prettity&#34;</span>

<span class="kwd" style="color: #008;">func</span> <span class="typ" style="color: #606;">Mark</span><span class="pun" style="color: #660;">(</span><span class="pln" style="color: #000;">out</span> <span class="pln" style="color: #000;">io</span><span class="pun" style="color: #660;">.</span><span class="typ" style="color: #606;">Writer</span><span class="pun" style="color: #660;">,</span> <span class="pln" style="color: #000;">src</span> <span class="pln" style="color: #000;">io</span><span class="pun" style="color: #660;">.</span><span class="typ" style="color: #606;">Reader</span><span class="pun" style="color: #660;">,</span> <span class="pln" style="color: #000;">highlight</span><span class="pun" style="color: #660;">,</span> <span class="pln" style="color: #000;">embed</span> <span class="kwd" style="color: #008;">bool</span><span class="pun" style="color: #660;">,</span> <span class="pln" style="color: #000;">theme</span> <span class="pun" style="color: #660;">.</span><span class="pun" style="color: #660;">.</span><span class="pun" style="color: #660;">.</span><span class="pln" style="color: #000;">string</span><span class="pun" style="color: #660;">)</span> <span class="pln" style="color: #000;">error</span> <span class="pun" style="color: #660;">{</span>
    <span class="pln" style="color: #000;">style</span> <span class="pun" style="color: #660;">=</span> <span class="typ" style="color: #606;">DeafultTheme</span>
    <span class="kwd" style="color: #008;">if</span> <span class="pln" style="color: #000;">len</span><span class="pun" style="color: #660;">(</span><span class="pln" style="color: #000;">theme</span><span class="pun" style="color: #660;">)</span> <span class="pun" style="color: #660;">&gt;</span> <span class="dec" style="color: #606;">0</span> <span class="pun" style="color: #660;">{</span>
        <span class="pln" style="color: #000;">style</span> <span class="pun" style="color: #660;">=</span> <span class="pln" style="color: #000;">theme</span><span class="pun" style="color: #660;">[</span><span class="dec" style="color: #606;">0</span><span class="pun" style="color: #660;">]</span>
    <span class="pun" style="color: #660;">}</span>
    <span class="pln" style="color: #000;">data</span><span class="pun" style="color: #660;">,</span> <span class="pln" style="color: #000;">err</span> <span class="pun" style="color: #660;">:</span><span class="pun" style="color: #660;">=</span> <span class="pln" style="color: #000;">ioutil</span><span class="pun" style="color: #660;">.</span><span class="typ" style="color: #606;">ReadAll</span><span class="pun" style="color: #660;">(</span><span class="pln" style="color: #000;">src</span><span class="pun" style="color: #660;">)</span>
    <span class="kwd" style="color: #008;">if</span> <span class="pln" style="color: #000;">err</span> <span class="pun" style="color: #660;">!</span><span class="pun" style="color: #660;">=</span> <span class="kwd" style="color: #008;">nil</span> <span class="pun" style="color: #660;">{</span>
        <span class="kwd" style="color: #008;">return</span> <span class="pln" style="color: #000;">err</span>
    <span class="pun" style="color: #660;">}</span>
    <span class="pln" style="color: #000;">opts</span> <span class="pun" style="color: #660;">:</span><span class="pun" style="color: #660;">=</span> <span class="pun" style="color: #660;">&amp;</span><span class="pln" style="color: #000;">mark</span><span class="pun" style="color: #660;">.</span><span class="typ" style="color: #606;">Options</span><span class="pun" style="color: #660;">{</span>
        <span class="typ" style="color: #606;">Gfm</span><span class="pun" style="color: #660;">:</span>       <span class="kwd" style="color: #008;">true</span><span class="pun" style="color: #660;">,</span>
        <span class="typ" style="color: #606;">Highlight</span><span class="pun" style="color: #660;">:</span> <span class="pln" style="color: #000;">highlight</span><span class="pun" style="color: #660;">,</span>
    <span class="pun" style="color: #660;">}</span>
    <span class="pln" style="color: #000;">m</span> <span class="pun" style="color: #660;">:</span><span class="pun" style="color: #660;">=</span> <span class="pln" style="color: #000;">mark</span><span class="pun" style="color: #660;">.</span><span class="typ" style="color: #606;">New</span><span class="pun" style="color: #660;">(</span><span class="pln" style="color: #000;">string</span><span class="pun" style="color: #660;">(</span><span class="pln" style="color: #000;">data</span><span class="pun" style="color: #660;">)</span><span class="pun" style="color: #660;">,</span> <span class="pun" style="color: #660;">&amp;</span><span class="pln" style="color: #000;">opts</span><span class="pun" style="color: #660;">)</span>
    <span class="pln" style="color: #000;">result</span> <span class="pun" style="color: #660;">:</span><span class="pun" style="color: #660;">=</span> <span class="pln" style="color: #000;">m</span><span class="pun" style="color: #660;">.</span><span class="typ" style="color: #606;">Render</span><span class="pun" style="color: #660;">(</span><span class="pun" style="color: #660;">)</span>
    <span class="kwd" style="color: #008;">if</span> <span class="pln" style="color: #000;">embed</span> <span class="pun" style="color: #660;">{</span>
        <span class="pln" style="color: #000;">result</span><span class="pun" style="color: #660;">,</span> <span class="pln" style="color: #000;">err</span> <span class="pun" style="color: #660;">=</span> <span class="typ" style="color: #606;">Embed</span><span class="pun" style="color: #660;">(</span><span class="pln" style="color: #000;">result</span><span class="pun" style="color: #660;">,</span> <span class="pln" style="color: #000;">style</span><span class="pun" style="color: #660;">)</span>
        <span class="kwd" style="color: #008;">if</span> <span class="pln" style="color: #000;">err</span> <span class="pun" style="color: #660;">!</span><span class="pun" style="color: #660;">=</span> <span class="kwd" style="color: #008;">nil</span> <span class="pun" style="color: #660;">{</span>
            <span class="kwd" style="color: #008;">return</span> <span class="pln" style="color: #000;">err</span>
        <span class="pun" style="color: #660;">}</span>
    <span class="pun" style="color: #660;">}</span>
    <span class="pln" style="color: #000;">_</span><span class="pun" style="color: #660;">,</span> <span class="pln" style="color: #000;">err</span> <span class="pun" style="color: #660;">=</span> <span class="pln" style="color: #000;">out</span><span class="pun" style="color: #660;">.</span><span class="typ" style="color: #606;">Write</span><span class="pun" style="color: #660;">(</span><span class="pun" style="color: #660;">[</span><span class="pun" style="color: #660;">]</span><span class="kwd" style="color: #008;">byte</span><span class="pun" style="color: #660;">(</span><span class="pln" style="color: #000;">result</span><span class="pun" style="color: #660;">)</span><span class="pun" style="color: #660;">)</span>
    <span class="kwd" style="color: #008;">return</span> <span class="pln" style="color: #000;">err</span>
<span class="pun" style="color: #660;">}</span>

<span class="kwd" style="color: #008;">func</span> <span class="typ" style="color: #606;">Embed</span><span class="pun" style="color: #660;">(</span><span class="pln" style="color: #000;">html</span> <span class="pln" style="color: #000;">string</span><span class="pun" style="color: #660;">,</span> <span class="pln" style="color: #000;">style</span> <span class="pln" style="color: #000;">string</span><span class="pun" style="color: #660;">)</span> <span class="pun" style="color: #660;">(</span><span class="pln" style="color: #000;">string</span><span class="pun" style="color: #660;">,</span> <span class="pln" style="color: #000;">error</span><span class="pun" style="color: #660;">)</span> <span class="pun" style="color: #660;">{</span>
    <span class="pln" style="color: #000;">sheet</span><span class="pun" style="color: #660;">,</span> <span class="pln" style="color: #000;">err</span> <span class="pun" style="color: #660;">:</span><span class="pun" style="color: #660;">=</span> <span class="pln" style="color: #000;">parser</span><span class="pun" style="color: #660;">.</span><span class="typ" style="color: #606;">Parse</span><span class="pun" style="color: #660;">(</span><span class="typ" style="color: #606;">GetStyle</span><span class="pun" style="color: #660;">(</span><span class="pln" style="color: #000;">style</span><span class="pun" style="color: #660;">)</span><span class="pun" style="color: #660;">)</span>
    <span class="kwd" style="color: #008;">if</span> <span class="pln" style="color: #000;">err</span> <span class="pun" style="color: #660;">!</span><span class="pun" style="color: #660;">=</span> <span class="kwd" style="color: #008;">nil</span> <span class="pun" style="color: #660;">{</span>
        <span class="kwd" style="color: #008;">return</span> <span class="str" style="color: #080;">&#34;&#34;</span><span class="pun" style="color: #660;">,</span> <span class="pln" style="color: #000;">err</span>
    <span class="pun" style="color: #660;">}</span>
    <span class="kwd" style="color: #008;">return</span> <span class="pln" style="color: #000;">inliner</span><span class="pun" style="color: #660;">.</span><span class="typ" style="color: #606;">NewInliner</span><span class="pun" style="color: #660;">(</span><span class="pln" style="color: #000;">html</span><span class="pun" style="color: #660;">,</span> <span class="pln" style="color: #000;">sheet</span><span class="pun" style="color: #660;">)</span><span class="pun" style="color: #660;">.</span><span class="typ" style="color: #606;">Inline</span><span class="pun" style="color: #660;">(</span><span class="pun" style="color: #660;">)</span>
<span class="pun" style="color: #660;">}</span>
<span class="kwd" style="color: #008;">func</span> <span class="typ" style="color: #606;">GetStyle</span><span class="pun" style="color: #660;">(</span><span class="pln" style="color: #000;">name</span> <span class="pln" style="color: #000;">string</span><span class="pun" style="color: #660;">)</span> <span class="pln" style="color: #000;">string</span> <span class="pun" style="color: #660;">{</span>
    <span class="pln" style="color: #000;">style</span><span class="pun" style="color: #660;">,</span> <span class="pln" style="color: #000;">ok</span> <span class="pun" style="color: #660;">:</span><span class="pun" style="color: #660;">=</span> <span class="pln" style="color: #000;">themes</span><span class="pun" style="color: #660;">[</span><span class="pln" style="color: #000;">name</span><span class="pun" style="color: #660;">]</span>
    <span class="kwd" style="color: #008;">if</span> <span class="pln" style="color: #000;">ok</span> <span class="pun" style="color: #660;">{</span>
        <span class="kwd" style="color: #008;">return</span> <span class="pln" style="color: #000;">style</span>
    <span class="pun" style="color: #660;">}</span>
    <span class="kwd" style="color: #008;">return</span> <span class="pln" style="color: #000;">themes</span><span class="pun" style="color: #660;">[</span><span class="typ" style="color: #606;">DeafultTheme</span><span class="pun" style="color: #660;">]</span>
<span class="pun" style="color: #660;">}</span>
</code></pre></body></html>